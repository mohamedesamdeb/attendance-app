<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="TRIO.PNG" type="image/png">
    <title>๐ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      /* ููุณ ุงูุชูุณููุงุช ุงูุณุงุจูุฉ */
      body {
        margin: 0;
        font-family: "Tahoma", sans-serif;
        background-color: #f1f1f1;
        padding: 20px;
        height: 100vh;
        overflow-x: hidden;
      }

      .container {
        max-width: 450px;
        margin: auto;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        position: relative;
      }

      h2 {
        text-align: center;
        color: #333;
        margin-bottom: 25px;
      }

      label {
        display: block;
        margin-top: 15px;
        margin-bottom: 5px;
        font-weight: bold;
        color: #444;
      }

      select,
      button {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 16px;
      }

      button {
        margin-top: 10px;
        cursor: pointer;
      }

      .btn-location {
        background-color: #007bff;
        color: #fff;
        border: none;
      }

      .btn-attendance {
        background-color: #28a745;
        color: white;
        border: none;
      }

      .btn-leave {
        background-color: #dc3545;
        color: white;
        border: none;
      }

      #locationDisplay {
        margin-top: 10px;
        color: #666;
        font-size: 14px;
      }

      #video {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 300px;
        max-width: 90vw;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        display: none;
        background: black;
      }

      canvas {
        display: none;
      }

      .warning-box {
        margin-top: 20px;
        background-color: #ffe6e6;
        border: 1px solid #ff4d4d;
        padding: 12px;
        border-radius: 8px;
        color: #b30000;
        font-weight: bold;
        font-size: 14px;
      }

      .warning-box ul {
        padding-right: 15px;
        margin: 8px 0 0 0;
        list-style-type: disc;
      }

      #progressCircleContainer {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 9999;
        display: none;
        background: white;
        border-radius: 50%;
        padding: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      /* ุฃููุงุท ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ */
      .sidebar-toggle {
        top: 20px;
        right: 20px;
        background: #f0f0f0;
        color: rgb(83, 83, 83);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 32px;
        cursor: pointer;
        z-index: 1000;
        
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .sidebar {
        position: fixed;
        top: 0;
        right: -500px;
        width: 300px;
        height: 100%;
        background: #fff;
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        transition: right 0.9s ease;
        padding: 20px;
        overflow-y: auto;
        border-radius: 20px;
      }

      .sidebar.active {
        right: 0;
      }

      .sidebar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .sidebar-title {
        font-size: 20px;
        font-weight: bold;
        color: #333;
      }

      .close-sidebar {
        background: #fff;
        color: rgb(0, 0, 0);
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        font-size: 48px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .sidebar-content {
        font-size: 16px;
        line-height: 1.6;
        color: #555;
      }

      /* ุฌุนู ูุงุฆูุฉ SweetAlert select ูุชุฌุงูุจุฉ */
.swal2-select {
  width: 80% !important;
  max-width: 80%;
  box-sizing: border-box;
  font-size: 14px;
}


      @media (max-width: 500px) {
        .container {
          padding: 15px;
        }

        h2 {
          font-size: 20px;
        }

        select,
        button {
          font-size: 15px;
          padding: 10px;
        }

        #video {
          width: 90vw;
        }

        .sidebar {
          width: 250px;
          right: -500px;
        }

        .sidebar.active {
          right: 0;
        }
      }
    </style>
  </head>
  <body>
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas" width="300" height="200"></canvas>

    <div id="progressCircleContainer">
      <svg id="progressCircle" width="120" height="120">
        <circle
          cx="60"
          cy="60"
          r="50"
          stroke="#e6e6e6"
          stroke-width="10"
          fill="none"
        />
        <circle
          id="progressCircleBar"
          cx="60"
          cy="60"
          r="50"
          stroke="#28a745"
          stroke-width="10"
          fill="none"
          stroke-linecap="round"
          transform="rotate(-90 60 60)"
          stroke-dasharray="314"
          stroke-dashoffset="314"
        />
        <text
          id="progressText"
          x="60"
          y="68"
          text-anchor="middle"
          font-size="22"
          fill="#333"
        >
          0%
        </text>
      </svg>
    </div>

    <!-- ุฒุฑ ูุชุญ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
    <button class="sidebar-toggle" onclick="toggleSidebar()">โฐ</button>

    <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">Trio-Telecom</div>
        <button class="close-sidebar" onclick="toggleSidebar()">ร</button>
      </div>
      <div class="sidebar-content">
        <hr />
        <button
          onclick="openLeaveForm()"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            background-color: #007bff;
            color: white;
            font-size: 16px;
            border: none;
            cursor: pointer;
          "
        >
ุงูุชูุฏูู ุนูู ุทูุจ ุฃุฌุงุฒุฉ ๐
        </button>

        <button
  onclick="window.location.href='https://mohamedesamdeb.github.io/refuling/';"
  style="
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    border: none;
    cursor: pointer;
  "
>
ุงุฑูุงู ุตูุฑ ุชูููู ุงููููุฏุง
        </button>


        <ul>
          <li>ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู</li>
          <li>ุฑูุงุจุท ุณุฑูุนุฉ</li>
          <li>ูุนูููุงุช ุงููุณุงุนุฏุฉ</li>
          <li>ุณุฌู ุงูุญุถูุฑ ุงูุณุงุจู</li>
        </ul>
      </div>
    </div>

    <div
      id="leaveForm"
      style="
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2000;
        background: white;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        padding: 20px;
        width: 90%;
        max-width: 400px;
      "
    >
      <h3 style="text-align: center; margin-bottom: 15px">
        ๐ ุชูุฏูู ุทูุจ ุฅุฌุงุฒุฉ
      </h3>
      <div id="leaveError" style="display:none; color: red; margin-bottom: 10px;"></div>


      <label for="leaveName">ุงุณู ุงูููู:</label>
      <select
        id="leaveName"
        style="width: 100%; padding: 10px; margin-bottom: 10px"
      >
        <option disabled selected>ุงุฎุชุฑ ุงุณู ุงูููู</option>
        <option>ูุญูุฏ ุนุจุฏู ุชูููู ุงุจูุฒูุฏ</option>
        <option>ูุฌุฏู ุนุจุฏ ุงููุฌูุฏ ุงุญูุฏ ุนุจุฏุงูุฑุญูู</option>
        <option>ุฃุญูุฏ ุนุฒุช ุนุจุฏุงูุนุฒูุฒ ุงุจุฑุงููู</option>
        <option>ุงุญูุฏ ุนูู ุนุจุฏ ุงูุญุงูุธ ูุฑุณู</option>
        <option>ุงุจุฑุงููู ุญุณูู ุนุจุฏู ุงุจุฑุงููู</option>
        <option>ููุฒู ูุญูุฏ ุนุจุฏ ุงูุดุงูู ูุทูุด</option>
        <option>ุนูู ุญุณู ุนูู</option>
        <option>ูุฑูุฏ ุงุจุฑุงููู ุนุจุงุณ</option>
        <option>ุญุณูู ููุงู ุญุณูู ูุญูุฏ</option>
        <option>ุนูู ุงุญูุฏ ุทูุทุงูู ููุตูุฑ</option>
        <option>ุจุงุณู ูุดุฃุช ุตุงูุญ</option>
        <option>ุณุนูุฏ ุญุณูู ุนูู</option>
        <option>ุดุงุฏู ุฑุฃูุช ุฑูุงุนู ูุญููุฏ ุตุงูุญ</option>
        <option>ูุญูุฏ ุญุณูู ูุญูุฏ ุนุงูุฑ</option>
        <option>ูุตุทูู ูุญููุฏ ุนุจุฏ ุงููุนูู ุนูุงุฑ</option>
        <option>ูุญููุฏ ูุญูุฏ ุนุจุฏุงูุญููุฏ ุงูุจูููู</option>
        <option>ูุตุทูู ุณุงูู ูุตุทูู</option>
        <option>ุฑุงูุช ุณูุฏ ุนุจุฏ ุงูุดููุฑ</option>
        <option>ุจูุงู ุฑูุถุงู ูุทุจ ุญุณู</option>
        <option>ูุงูู ุนุจุฏุงูุญููุฏ ุงุญูุฏ ุนุจุฏ ุงููุชุงุญ</option>
        <option>ูุญูุฏ ุงุญูุฏ ุงุญูุฏ ูุญูุฏ ุงุญูุฏ</option>
        <option>ูุงุฌุฏ ุญุณูู</option>
        <option>ูุงุฏุฑ ูุฌูุจ ุญูุง ูุนููุจ</option>
        <option>ุงููู ุฌูุงู ุฌุฑุฌุณ ุงุจุฑุงููู</option>
        <option>ููุซู ูุตุทูู ูุตุทูู ุนุจุฏ ุงููุทูู</option>
      </select>

      <label for="leaveOffice">ุงูููุชุจ:</label>
      <select
        id="leaveOffice"
        style="width: 100%; padding: 10px; margin-bottom: 10px"
      >
        <option disabled selected>ุงุฎุชุฑ ุงูููุชุจ</option>
        <option>ุดุจุฑุง</option>
        <option>ุฌุณุฑ ุงูุณููุณ</option>
        <option>ุงููููุฏุณูู</option>
      </select>

      <label for="leaveDateFrom"> ุชุงุฑูุฎ ุงูุฅุฌุงุฒุฉ ูู:</label>
      <input
        type="date"
        id="leaveDateFrom"
        style="
          width: 95%;
          padding: 10px;
          margin-bottom: 10px;
          border-radius: 10px;
        "
      />

      <label for="leaveDateTo"> ุชุงุฑูุฎ ุงูุฅุฌุงุฒุฉ ุงูู:</label>
      <input
        type="date"
       id="leaveDateTo"
        style="
          width: 95%;
          padding: 10px;
          margin-bottom: 10px;
          border-radius: 10px;
        "
      />

      <label for="leaveReason">ุณุจุจ ุงูุฅุฌุงุฒุฉ:</label>
      <textarea
        id="leaveReason"
        placeholder="ุงูุชุจ ุณุจุจ ุงูุฅุฌุงุฒุฉ"
        style="resize: none; width: 95%; padding: 10px; height: 80px; margin-bottom: 15px; border-radius: 10px;"
      ></textarea>

      <button
        onclick="submitLeaveRequest()"
        style="
          width: 100%;
          padding: 12px;
          background-color: #28a745;
          color: white;
          border: none;
          border-radius: 8px;
          font-size: 16px;
        "
      >
        ๐จ ุชูุฏูู ุงูุทูุจ
      </button>

      <button
        onclick="closeLeaveForm()"
        style="
          width: 100%;
          padding: 10px;
          background: red;
          border: none;
          color: wheat;
          margin-top: 10px;
        "
      >
        ุฅุบูุงู
      </button>
    </div>

    <div class="container">
      <h2>Trio-Telecom</h2>
      <h2>๐ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู</h2>

      <label for="technicianSelect">ุงุณู ุงูููู:</label>
      <select id="technicianSelect">
        <option disabled selected>ุงุฎุชุฑ ุงุณู ุงูููู</option>
        <option>ูุญูุฏ ุนุจุฏู ุชูููู ุงุจูุฒูุฏ</option>
        <option>ูุฌุฏู ุนุจุฏ ุงููุฌูุฏ ุงุญูุฏ ุนุจุฏุงูุฑุญูู</option>
        <option>ุฃุญูุฏ ุนุฒุช ุนุจุฏุงูุนุฒูุฒ ุงุจุฑุงููู</option>
        <option>ุงุญูุฏ ุนูู ุนุจุฏ ุงูุญุงูุธ ูุฑุณู</option>
        <option>ุงุจุฑุงููู ุญุณูู ุนุจุฏู ุงุจุฑุงููู</option>
        <option>ููุฒู ูุญูุฏ ุนุจุฏ ุงูุดุงูู ูุทูุด</option>
        <option>ุนูู ุญุณู ุนูู</option>
        <option>ูุฑูุฏ ุงุจุฑุงููู ุนุจุงุณ</option>
        <option>ุญุณูู ููุงู ุญุณูู ูุญูุฏ</option>
        <option>ูุญูุฏ ุงุญูุฏ ุนุจุฏ ุงูุญููุฏ ุงุญูุฏ</option>
        <option>ุนูู ุงุญูุฏ ุทูุทุงูู ููุตูุฑ</option>
        <option>ุจุงุณู ูุดุฃุช ุตุงูุญ</option>
        <option>ุณุนูุฏ ุญุณูู ุนูู</option>
        <option>ุดุงุฏู ุฑุฃูุช ุฑูุงุนู ูุญููุฏ ุตุงูุญ</option>
        <option>ูุญูุฏ ุญุณูู ูุญูุฏ ุนุงูุฑ</option>
        <option>ูุตุทูู ูุญููุฏ ุนุจุฏ ุงููุนูู ุนูุงุฑ</option>
        <option>ูุญููุฏ ูุญูุฏ ุนุจุฏุงูุญููุฏ ุงูุจูููู</option>
        <option>ูุตุทูู ุณุงูู ูุตุทูู</option>
        <option>ุฑุงูุช ุณูุฏ ุนุจุฏ ุงูุดููุฑ</option>
        <option>ุจูุงู ุฑูุถุงู ูุทุจ ุญุณู</option>
        <option>ูุงูู ุนุจุฏุงูุญููุฏ ุงุญูุฏ ุนุจุฏ ุงููุชุงุญ</option>
        <option>ูุญูุฏ ุงุญูุฏ ุงุญูุฏ ูุญูุฏ ุงุญูุฏ</option>
        <option>ูุงุฌุฏ ุญุณูู</option>
        <option>ูุงุฏุฑ ูุฌูุจ ุญูุง ูุนููุจ</option>
        <option>ุงููู ุฌูุงู ุฌุฑุฌุณ ุงุจุฑุงููู</option>
        <option>ููุซู ูุตุทูู ูุตุทูู ุนุจุฏ ุงููุทูู</option>
      </select>

      <label for="officeSelect">ุงูููุชุจ:</label>
      <select id="officeSelect">
        <option disabled selected>ุงุฎุชุฑ ุงูููุชุจ</option>
        <option>ุดุจุฑุง</option>
        <option>ุฌุณุฑ ุงูุณููุณ</option>
        <option>ุงููููุฏุณูู</option>
      </select>

      <button class="btn-location" onclick="getLocation()">
        ๐ ุชุญุฏูุฏ ูููุนู
      </button>
      <div id="locationDisplay">ูู ูุชู ุชุญุฏูุฏ ุงููููุน</div>

      <button class="btn-attendance" onclick="startProcess('ุญุถูุฑ')">
        โ ุชุณุฌูู ุญุถูุฑ
      </button>
      <button class="btn-leave" onclick="startProcess('ุงูุตุฑุงู')">
        ๐ค ุชุณุฌูู ุงูุตุฑุงู
      </button>

      <div class="warning-box">
        โ๏ธ ููู ุฌุฏุงู:
        <ul>
          <li>ูุงุฒู ุงูุตูุฑุฉ ุชููู ูุงุถุญุฉ.</li>
          <li>ุฑูุฒ ูุงูุช ุจุชุถุบุท ุชุณุฌูู ุญุถูุฑ ุฃู ุงูุตุฑุงู.</li>
          <li>ูุงุฒู ุชุถุบุท ุนูู ุฒุฑ ุชุญุฏูุฏ ุงููููุน.</li>
          <li>ุฅุฐุง ูู ูุชู ุชุณุฌูู ุงูุญุถูุฑ ูุชู ุชุบูุจ ุงูููู.</li>
        </ul>
        ุฃู ุจูุฏ ูู ุงูุงุฑุจุนุฉ ูุด ูุชุทุจู ูุชู ุงุญุชุณุงุจ ุชุฃุฎูุฑ.
      </div>
    </div>

    <script>
      let lat = "",
        lng = "";

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("active");
      }

      function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          // ุชุนุฑูู ุงููุชุบูุฑุงุช ุจุดูู ุตุญูุญ
          let lat = pos.coords.latitude.toFixed(6);
          let lng = pos.coords.longitude.toFixed(6);

          // ุนุฑุถ ุงููุชูุฌุฉ ูู ุงูุตูุญุฉ
          document.getElementById("locationDisplay").textContent =
            `๐ ุงููููุน ุงูุญุงูู: ${lat}, ${lng}`;
        },
        (err) => {
          // ุงูุชุนุงูู ูุน ุฃููุงุน ุงูุฃุฎุทุงุก ุงููุฎุชููุฉ
          let message = "ูุดู ูู ุชุญุฏูุฏ ุงููููุน";
          if (err.code === 1) message = "๐ซ ุชู ุฑูุถ ุงูุฅุฐู ุจุชุญุฏูุฏ ุงููููุน";
          else if (err.code === 2) message = "๐ก ูุง ูููู ุชุญุฏูุฏ ุงููููุน ุญุงูููุง";
          else if (err.code === 3) message = "โฑ๏ธ ุงูุชูุช ูููุฉ ุชุญุฏูุฏ ุงููููุน";

          Swal.fire("โ๏ธ", message, "warning");
        },
        {
          enableHighAccuracy: true, // ูุทูุจ ุชุญุฏูุฏ ุฏููู ูู GPS
          timeout: 10000,           // ูููู 10 ุซูุงูู ุจุณ
          maximumAge: 0             // ูุงูุนุชูุฏุด ุนูู ูููุน ูุฏูู
        }
      );
    } else {
      Swal.fire("โ๏ธ", "ุงููุชุตูุญ ูุง ูุฏุนู ุชุญุฏูุฏ ุงููููุน", "warning");
    }
  }

      async function startProcess(action) {
  const name = document.getElementById("technicianSelect").value;
  const office = document.getElementById("officeSelect").value;

  if (!name || name === "ุงุฎุชุฑ ุงุณู ุงูููู" || !office || office === "ุงุฎุชุฑ ุงูููุชุจ") {
    Swal.fire("ุชูุจูู", "ูุฑุฌู ุงุฎุชูุงุฑ ุงูููู ูุงูููุชุจ", "info");
    return;
  }

  if (!lat || !lng) {
    Swal.fire("ุชูุจูู", "ูู ูุชู ุชุญุฏูุฏ ุงููููุนุ ูู ูุถูู ุญุฏุฏ ุงููููุน ุซู ุฃุนุฏ ุงููุญุงููุฉู", "info");
    return;
  }

  // ๐ ุชุญูู ูู ููุช ุงูุงูุตุฑุงู ุงููุจูุฑ
  let leaveReason = "";
  if (action === "ุงูุตุฑุงู") {
    const now = new Date();
    const hour = now.getHours();
    const minute = now.getMinutes();

    if (hour < 16 || (hour === 16 && minute < 15)) {
      const { value: reason } = await Swal.fire({
        title: "๐จ ุงูุตุฑุงู ูุจูุฑ",
        text: "ุจุฑุฌุงุก ุงุฎุชูุงุฑ ุณุจุจ ุงูุงูุตุฑุงู ุงููุจูุฑ:",
        input: "select",
        inputOptions: {
          " ุญุงูุฉ ุทุงุฑุฆุฉ": " ุญุงูุฉ ุทุงุฑุฆุฉ ",
          "ุงูุตุฑุงู ุจุนูู ุงููุฏูุฑ  ": "ุงูุตุฑุงู ุจุนูู ุงููุฏูุฑ  ",
          "ุชู ุญุถูุฑ ุฒูููู ู ุชุณูููู ูุจูุฑ": "ุชู ุญุถูุฑ ุฒูููู ู ุชุณูููู ูุจูุฑ"
        },
        inputPlaceholder: "ุงุฎุชุฑ ุงูุณุจุจ",
        showCancelButton: true,
        confirmButtonText: "ุชุฃููุฏ"
      });

      if (!reason) {
        Swal.fire("ุชู ุงูุฅูุบุงุก", "ูู ูุชู ุชุณุฌูู ุงูุงูุตุฑุงู", "info");
        return;
      }

      leaveReason = reason;
    }
  }

  // โ ุชุตููุฑ ูู ุงููุงููุฑุง
  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");

  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "user" },
    });
    video.srcObject = stream;
    video.style.display = "block";

    setTimeout(() => {
      canvas.getContext("2d").drawImage(video, 0, 0, canvas.width, canvas.height);
      const image = canvas.toDataURL("image/png");
      stream.getTracks().forEach((track) => track.stop());
      video.style.display = "none";

      // ๐ ุฅุฑุณุงู ุงูุจูุงูุงุช ูุน ุงูุณุจุจ
      sendData({ name, action, office, image, leaveReason });
    }, 3000);
  } catch (err) {
    Swal.fire("โ๏ธ", "ูุดู ูู ุชุดุบูู ุงููุงููุฑุง", "error");
  }
}


      function sendData({ name, action, office, image }) {
        const data = {
          name,
          action,
          office,
          time: new Date().toLocaleString("ar-EG"),
          lat,
          lng,
          image,
        };

        const circleContainer = document.getElementById(
          "progressCircleContainer"
        );
        const progressBar = document.getElementById("progressCircleBar");
        const progressText = document.getElementById("progressText");

        circleContainer.style.display = "block";
        let percent = 0;

        const interval = setInterval(() => {
          if (percent < 90) {
            percent++;
            const offset = 314 - (314 * percent) / 100;
            progressBar.setAttribute("stroke-dashoffset", offset);
            progressText.textContent = `${percent}%`;
          }
        }, 50);

        fetch(
          "https://script.google.com/macros/s/AKfycbwcZZ7i7EPEGl3zLJ_ocU5Fh1BLjz6fmgujq8fL4GsgR1n0bwuQn7I3YMOi2ksLCj2LLw/exec",
          {
            method: "POST",
            body: JSON.stringify(data),
          }
        )
          .then((res) => res.text())
          .then((msg) => {
            clearInterval(interval);
            let finalPercent = percent;
            const complete = setInterval(() => {
              if (finalPercent < 100) {
                finalPercent++;
                const offset = 314 - (314 * finalPercent) / 100;
                progressBar.setAttribute("stroke-dashoffset", offset);
                progressText.textContent = `${finalPercent}%`;
              } else {
                clearInterval(complete);
                setTimeout(() => {
                  circleContainer.style.display = "none";
                  Swal.fire({
                    icon: "success",
                    title: "โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ",
                    confirmButtonText: "OK",
                  }).then(() => {
                    // ุชูุฑูุบ ุงูุญููู ุจุนุฏ ุงูุถุบุท OK
                    document.getElementById(
                      "technicianSelect"
                    ).selectedIndex = 0;
                    document.getElementById("officeSelect").selectedIndex = 0;
                    lat = "";
                    lng = "";
                    document.getElementById("locationDisplay").textContent =
                      "ูู ูุชู ุชุญุฏูุฏ ุงููููุน";
                  });
                }, 300);
              }
            }, 20);
          })
          .catch((err) => {
            clearInterval(interval);
            circleContainer.style.display = "none";
            Swal.fire("โ ุฎุทุฃ", "ูุดู ูู ุฅุฑุณุงู ุงูุจูุงูุงุช", "error");
          });
      }

      function openLeaveForm() {
        document.getElementById("leaveForm").style.display = "block";
      }

      function closeLeaveForm() {
        document.getElementById("leaveForm").style.display = "none";
      }

      function submitLeaveRequest() {
        const name = document.getElementById("leaveName").value;
        const office = document.getElementById("leaveOffice").value;
        const date = document.getElementById("leaveDate").value;
        const reason = document.getElementById("leaveReason").value;

        if (
  !name ||
  name === "ุงุฎุชุฑ ุงุณู ุงูููู" ||
  !office ||
  office === "ุงุฎุชุฑ ุงูููุชุจ" ||
  !date ||
  !reason
) {
  const errorBox = document.getElementById("leaveError");
  errorBox.textContent = "ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู";
  errorBox.style.display = "block";
  return;
}


        // ููุง ูููู ุชุถูู ุงูููุฏ ุงูุฎุงุต ุจุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู ุฌูุฌู ุดูุช ูุซูุงู

        document.getElementById("leaveForm").style.display = "none";

        Swal.fire({
          icon: "success",
          title: "ุชู ุฅุฑุณุงู ุงูุทูุจ ุจูุฌุงุญ",
          showConfirmButton: false,
          timer: 2500,
        }).then(() => {
          // ุฅุบูุงู ูููุฐุฌ ุงูุฅุฌุงุฒุฉ

          // ุชูุฑูุบ ุงูุญููู (ุงุฎุชูุงุฑู)
          document.getElementById("leaveName").selectedIndex = 0;
          document.getElementById("leaveOffice").selectedIndex = 0;
          document.getElementById("leaveDate").value = "";
          document.getElementById("leaveReason").value = "";
        });
      }

      // ุฅุบูุงู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ููุง ูุชู ุงูุถุบุท ุนูู ุฃู ุฒุฑ ุฏุงุฎููุง
document.querySelectorAll("#sidebar button").forEach((btn) => {
  btn.addEventListener("click", () => {
    document.getElementById("sidebar").classList.remove("active");
  });
});
    </script>
  </body>
</html>

